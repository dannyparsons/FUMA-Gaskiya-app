{"version":3,"sources":["../../src/pages/variete/ajouter-variete/ajouter-variete.ts","../../src/pages/variete/ajouter-variete/ajouter-variete.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAA0C;AACiD;AAClC;AAEhB;AAC6B;AACxB;AACN;AAExC;;;;;EAKE;AAMF,IAAa,kBAAkB;IAQ7B,4BAAmB,OAAsB,EAAS,SAAoB,EAAS,GAAQ,EAAS,MAAc,EAAS,QAAyB,EAAS,cAA+B,EAAS,QAAyB,EAAS,WAAwB,EAAS,OAAgB;QAApR,iBA4BC;QA5BkB,YAAO,GAAP,OAAO,CAAe;QAAS,cAAS,GAAT,SAAS,CAAW;QAAS,QAAG,GAAH,GAAG,CAAK;QAAS,WAAM,GAAN,MAAM,CAAQ;QAAS,aAAQ,GAAR,QAAQ,CAAiB;QAAS,mBAAc,GAAd,cAAc,CAAiB;QAAS,aAAQ,GAAR,QAAQ,CAAiB;QAAS,gBAAW,GAAX,WAAW,CAAa;QAAS,YAAO,GAAP,OAAO,CAAS;QALpR,aAAQ,GAAQ,EAAE,CAAC;QACnB,eAAU,GAAQ,EAAE,CAAC;QACrB,SAAI,GAAQ,EAAE,CAAC;QACf,gBAAW,GAAQ,EAAE,CAAC;QAGpB,IAAI,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC;QACxB,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;QAEvF,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,cAAc,EAAC,qBAAqB,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC;YAC1E,KAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;QAEpB,CAAC,EAAE,aAAG,IAAI,cAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAhB,CAAgB,CAAC,CAAC;QAE9B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACzC,YAAY;YACX,IAAI,EAAC,CAAC,SAAS,CAAC;YAChB,GAAG,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,QAAQ,CAAC;YAC9B,IAAI,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,QAAQ,CAAC;YAC/B,OAAO,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,QAAQ,CAAC;YAClC,YAAY,EAAE,CAAC,EAAE,CAAC;YAClB,cAAc,EAAE,CAAC,EAAE,CAAC;YACpB,YAAY,EAAE,CAAC,EAAE,CAAC;YAClB,oBAAoB;YACpB,WAAW,EAAE,CAAC,EAAE,CAAC;YACjB,KAAK,EAAE,CAAC,KAAK,EAAE,kEAAU,CAAC,QAAQ,CAAC;YACnC,QAAQ,EAAE,CAAC,EAAE,CAAC;YACd,IAAI,EAAE,CAAC,EAAE,CAAC;YACV,WAAW,EAAE,CAAC,EAAE,CAAC;YACjB,KAAK,EAAE,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;YACxB,GAAG,EAAE,CAAC,EAAE,CAAC;SACV,CAAC,CAAC;IAEL,CAAC;IAED,gCAAG,GAAH,UAAI,GAAgB;QAAhB,8BAAgB;QAClB,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC/B,OAAO,EAAE,GAAG;YACZ,QAAQ,EAAE,KAAK;YACf,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;QAEH,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,+CAAkB,GAAlB,UAAmB,OAAO;QAExB,IAAI,GAAG,GAAG,CAAC,CAAC;QACZ,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAC,CAAC,EAAE,KAAK;YAC/B,EAAE,EAAC,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC,EAAC;gBACnF,GAAG,GAAG,CAAC,CAAC;YACV,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,GAAG,CAAC;IACb,CAAC;IAGD,uCAAU,GAAV,UAAW,IAAS,EAAE,GAAQ,EAAE,KAAU;QACxC,IAAI,CAAC,GAAG,KAAK,GAAC,GAAG,CAAC;QAClB,GAAG,IAAI,CAAC,CAAC;QACT,EAAE,EAAC,GAAG,GAAG,EAAE,CAAC,EAAC;YACX,CAAC,IAAI,GAAG,GAAC,GAAG,GAAC,GAAG,CAAC;QACnB,CAAC;QAAA,IAAI,EAAC;YACJ,CAAC,IAAI,GAAG,GAAC,GAAG,CAAC;QACf,CAAC;QAED,EAAE,EAAC,IAAI,GAAG,EAAE,CAAC,EAAC;YACZ,CAAC,IAAI,GAAG,GAAC,IAAI,CAAC;QAChB,CAAC;QAAA,IAAI,EAAC;YACJ,CAAC,IAAI,IAAI,CAAC;QACZ,CAAC;QACD,MAAM,CAAC,CAAC,CAAC;IACX,CAAC;IAED,4CAAe,GAAf;QAAA,iBA2BC;QAxBC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,IAAI,CACxB,UAAC,IAAI;YACH,EAAE,EAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,EAAC;gBACxB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,QAAQ,EAAE,CAAC;oBAC7B,EAAE,EAAC,QAAQ,CAAC,WAAW,CAAC,EAAC;wBACvB,KAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,WAAW,CAAC;oBAC1C,CAAC;oBACD,EAAE,EAAC,QAAQ,CAAC,QAAQ,CAAC,EAAC;wBACpB,KAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC;oBAChC,CAAC;gBACH,CAAC,CAAC;YACJ,CAAC;YAAA,IAAI,EAAC;gBACJ,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;gBACpC,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC5B,CAAC;QAEH,CAAC,EACD,UAAC,GAAG,IAAK,cAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,GAAG,CAAC,EAA5C,CAA4C,CACtD,CAAC;QAEA,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,cAAc,EAAC,qBAAqB,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC;YAC5E,KAAI,CAAC,UAAU,GAAG,CAAC,CAAC;QAEtB,CAAC,EAAE,aAAG,IAAI,cAAO,CAAC,GAAG,CAAC,GAAG,CAAC,EAAhB,CAAgB,CAAC,CAAC;IAChC,CAAC;IAED,uCAAU,GAAV;QACE,IAAI,KAAK,GAAC,0BAA0B;QACpC,IAAI,OAAO,GAAC,YAAY;QACxB,IAAI,WAAW,GAAC,EAAE;QAClB,GAAG,EAAC,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,EAAE,EAAC,CAAC,EAAE,EAAC,CAAC;YACpB,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAC,EAAE,CAAC;YACvC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACjC,CAAC;QACD,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC;QACrB,GAAG,EAAC,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,EAAE,EAAC,CAAC,EAAE,EAAC,CAAC;YACpB,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAC,EAAE,CAAC;YACvC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,CAAC;QAED,IAAI,YAAY,GAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACtC,IAAI,EAAE,GAAE,YAAY;QACpB,MAAM,CAAC,EAAE,CAAC;IACZ,CAAC;IAEA,oCAAO,GAAP;QAEC,IAAI,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QACtB,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QACrC,EAAE,EAAC,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAC;YACzC,KAAK,CAAC,yCAAyC,CAAC,CAAC;QACnD,CAAC;QAAA,IAAI,EAAC;YACJ,OAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;YACpC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;YACvC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;YACzB,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;YAC3B,yBAAyB;YACzB,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;YAE5B,IAAI,YAAY,GAAQ,EAAE,CAAC;YAC3B,YAAY,CAAC,GAAG,GAAG,MAAM,GAAC,WAAW,GAAE,EAAE,CAAC;YAC1C,YAAY,CAAC,IAAI,GAAG,OAAO;YAC3B,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;YAC5C,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;gBAC/B,OAAO,EAAE,2BAA2B;gBACpC,QAAQ,EAAE,KAAK;gBACf,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YAEH,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;QACrB,CAAC;IACH,CAAC;IAED,oCAAO,GAAP;QACE,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;IACrB,CAAC;IAEH,yBAAC;AAAD,CAAC;AA/JY,kBAAkB;IAJ9B,wEAAS,CAAC;QACT,QAAQ,EAAE,sBAAsB;OACG;KACpC,CAAC;uBASoR;AAuJrR;SA/JY,kBAAkB,gB;;;;;;;;;;;;;;;;;;;ACpBU;AACO;AACO;AAOvD,IAAa,wBAAwB;IAArC;IAAwC,CAAC;IAAD,+BAAC;AAAD,CAAC;AAA5B,wBAAwB;IALpC,uEAAQ,CAAC;QACR,YAAY,EAAE,CAAC,4EAAkB,CAAC;QAClC,OAAO,EAAE,CAAC,sEAAe,CAAC,QAAQ,CAAC,4EAAkB,CAAC,CAAC;QACvD,OAAO,EAAE,CAAC,4EAAkB,CAAC;KAC9B,CAAC;GACW,wBAAwB,CAAI;AAAJ","file":"15.js","sourcesContent":["import { Component } from '@angular/core';\nimport { NavController, NavParams, ToastController, AlertController, IonicPage } from 'ionic-angular';\nimport { Validators, FormBuilder } from '@angular/forms';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Storage } from '@ionic/storage';\nimport { PouchdbProvider } from '../../../providers/pouchdb-provider';\nimport { Device } from '@ionic-native/device';\nimport { Sim } from '@ionic-native/sim';\n\n/*\n  Generated class for the AjouterVariete page.\n\n  See http://ionicframework.com/docs/v2/components/#navigation for more info on\n  Ionic pages and navigation.\n*/\n@IonicPage()\n@Component({\n  selector: 'page-ajouter-variete',\n  templateUrl: 'ajouter-variete.html'\n})\nexport class AjouterVarietePage {\n\n  varieteForm: any;\n  cultures: any = [];\n  allVariete: any = [];  \n  imei: any = '';\n  phonenumber: any = '';\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public sim: Sim, public device: Device, public toastCtl: ToastController, public servicePouchdb: PouchdbProvider, public alertCtl: AlertController, public formBuilder: FormBuilder, public storage: Storage) {\n    let maDate = new Date();\n    let today = this.createDate(maDate.getDate(), maDate.getMonth(), maDate.getFullYear());\n\n    this.servicePouchdb.getPlageDocs('fuma:culture','fuma:culture:\\uffff').then((c) => {\n        this.cultures = c;\n\n      }, err => console.log(err)); \n\n    this.varieteForm = this.formBuilder.group({\n     // _id:[''],\n      type:['variete'],\n      nom: ['', Validators.required],\n      code: ['', Validators.required],\n      culture: ['', Validators.required],\n      pays_origine: [''],\n      region_origine: [''],\n      longeur_tige: [''],\n      //longeur_epi: [''],\n      description: [''],\n      today: [today, Validators.required],\n      deviceid: [''],\n      imei: [''],\n      phonenumber: [''],\n      start: [maDate.toJSON()],\n      end: ['']\n    });\n    \n  }\n\n  msg(msg: string = ''){\n    let toast = this.toastCtl.create({\n      message: msg,\n      position: 'top',\n      duration: 3000\n    });\n\n    toast.present();\n  }\n\n  verifierUniqueCode(variete){\n  \n    let res = 1;\n    this.allVariete.forEach((c, index) => {\n      if((variete.code.toString().toLowerCase() === c.data.code.toString().toLowerCase())){\n        res = 0;\n      }\n    });\n\n    return res;\n  }\n\n\n  createDate(jour: any, moi: any, annee: any){\n    let s = annee+'-';\n    moi += 1;\n    if(moi < 10){\n      s += '0'+moi+'-';\n    }else{\n      s += moi+'-';\n    }\n\n    if(jour < 10){\n      s += '0'+jour;\n    }else{\n      s += jour;\n    }\n    return s;\n  }\n\n  ionViewDidEnter() {\n\n    \n    this.sim.getSimInfo().then(\n      (info) => {\n        if(info.cards.length > 0){\n          info.cards.forEach((infoCard, i) => {\n            if(infoCard.phoneNumber){\n              this.phonenumber = infoCard.phoneNumber;\n            }\n            if(infoCard.deviceId){\n              this.imei = infoCard.deviceId;\n            }\n          })\n        }else{\n          this.phonenumber = info.phoneNumber;\n          this.imei = info.deviceId;\n        }\n\n      },\n      (err) => console.log('Unable to get sim info: ', err)\n    );\n\n      this.servicePouchdb.getPlageDocs('fuma:variete','fuma:variete:\\uffff').then((v) => {\n        this.allVariete = v;\n\n      }, err => console.log(err));      \n  }\n\n  generateId(){\n    var chars='ABCDEFGHIJKLMNPQRSTUVWYZ'\n    var numbers='0123456789'\n    var randomArray=[]\n    for(let i=0;i<10;i++){\n      var rand = Math.floor(Math.random()*10)\n      randomArray.push(numbers[rand])\n    }\n    randomArray.push('-')\n    for(let i=0;i<10;i++){\n      var rand = Math.floor(Math.random()*24)\n      randomArray.push(chars[rand])\n    }\n   \n    var randomString=randomArray.join(\"\");\n    var Id= randomString \n    return Id;\n  }\n\n   ajouter(){\n    \n    let date = new Date();\n    let variete = this.varieteForm.value;\n    if(this.verifierUniqueCode(variete) === 0){\n      alert('Le code de la variété doit être unique!');\n    }else{\n      variete.deviceid = this.device.uuid;\n      variete.phonenumber = this.phonenumber;\n      variete.imei = this.imei;\n      let id = this.generateId();\n      //union._id = 'fuma'+ id;\n      variete.end = date.toJSON();\n\n      let varieteFinal: any = {};\n      varieteFinal._id = 'fuma'+':variete:'+ id;\n      varieteFinal.data = variete\n      this.servicePouchdb.createDoc(varieteFinal);\n      let toast = this.toastCtl.create({\n        message: 'Variété bien enregistrée!',\n        position: 'top',\n        duration: 3000\n      });\n\n      toast.present();\n      this.navCtrl.pop();\n    }\n  }\n\n  annuler(){\n    this.navCtrl.pop();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/variete/ajouter-variete/ajouter-variete.ts","import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AjouterVarietePage } from './ajouter-variete';\r\n\r\n@NgModule({\r\n  declarations: [AjouterVarietePage],\r\n  imports: [IonicPageModule.forChild(AjouterVarietePage)],\r\n  exports: [AjouterVarietePage]\r\n})\r\nexport class AjouterVarietePageModule { }\r\n \n\n\n// WEBPACK FOOTER //\n// ./src/pages/variete/ajouter-variete/ajouter-variete.module.ts"],"sourceRoot":""}